
<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Move the Ball</title>
<meta name="viewport" content="width=device-width,user-scalable=no" />
<script src="http://debug.phonegap.com/target/target-script-min.js#accelerometer"></script>
<style>
#no {
    display: none;  
}
#ball {
    width: 20px;
    height: 20px;
    border-radius: 10px;
    -webkit-radius: 10px;
    background-color: red;
    position:absolute;
    top: 0px;
    left: 0px;
}
</style>
</head>

<body>
<div id="content">
    <h1>Testing Phone Gyroscope and Accelerometer</h1>
    <div id="yes">
    </div>
    <div id="no">
    Your browser does not support Device Orientation and Motion API. Try this sample with iPhone, iPod or iPad with iOS 4.2+.    
    </div>

    <div id="outputAcc"></div>
    <div id="outputGyro"></div>
</div>
<script>


// Position Variables
var x = 0;
var y = 0;
var z = 0;

// Speed - Velocity
var vx = 0;
var vy = 0;
var vz = 0;

// Acceleration
var ax = 0;
var ay = 0;
var az = 0;


if (window.DeviceMotionEvent==undefined) {
    document.getElementById("no").style.display="block";
    document.getElementById("yes").style.display="none";

} else {
    window.ondevicemotion = function(event) {
        ax = event.accelerationIncludingGravity.x;
        ay = event.accelerationIncludingGravity.y;
        az = event.accelerationIncludingGravity.z;
        var output_xyz = "<h3>Accelerometer data</h3> x: " + event.accelerationIncludingGravity.x.toFixed(1) + " y: " + event.accelerationIncludingGravity.y.toFixed(1) + " z: " + event.accelerationIncludingGravity.z.toFixed(1) ;

        $('#outputAcc').html(output_xyz);

    };

    window.ondeviceorientation = function(event) {
        a_alpha = event.alpha;
        a_beta = event.beta;
        a_gamma = event.gamma;

        var output_gyro = "<h3>Gyroscope data</h3> Alpha: " + event.alpha.toFixed(2) + " Beta: " + event.beta.toFixed(2) + " Gamma: " + event.gamma.toFixed(2);
        $('#outputGyro').html(output_gyro);
    };

    setInterval(function() {
        vy = vy + -(ay);
        vx = vx + ax;

        var ball = document.getElementById("ball");
        y = parseInt(y + vy * vMultiplier);
        x = parseInt(x + vx * vMultiplier);
        
        if (x<0) { x = 0; vx = 0; }
        if (y<0) { y = 0; vy = 0; }
        if (x>document.documentElement.clientWidth-20) { x = document.documentElement.clientWidth-20; vx = 0; }
        if (y>document.documentElement.clientHeight-20) { y = document.documentElement.clientHeight-20; vy = 0; }
        
        ball.style.top = y + "px";
        ball.style.left = x + "px";
    }, delay);
} 

</script>

</body>
</html>
